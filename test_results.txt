
> chapter@0.0.1 lint-and-test
> npm run lint && npm run test


> chapter@0.0.1 lint
> eslint './**/*.{ts,tsx,js,jsx}'


> chapter@0.0.1 test
> jest --coverage --verbose

  console.warn
    WARN: oauth2.keys.json file missing, the Google Calendar integration will not work.

      30 |     return { keys };
      31 |   } catch {
    > 32 |     console.warn(
         |             ^
      33 |       'WARN: oauth2.keys.json file missing, the Google Calendar integration will not work.',
      34 |     );
      35 |   }

      at warn (server/src/services/InitGoogle.ts:32:13)
      at Object.init (server/src/services/InitGoogle.ts:40:18)
      at server/tests/google.test.ts:75:31
      at Object.require (server/src/services/Google.ts:6:1)
      at Object.<anonymous> (server/tests/google.test.ts:4:1)

------------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File                                | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
------------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
All files                           |   70.97 |    69.21 |   54.12 |    68.9 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 client/src/components              |    91.3 |       80 |     100 |      95 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  ChapterCard.tsx                   |     100 |    83.33 |     100 |     100 | 47,163                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  EventCard.tsx                     |   86.21 |    76.92 |     100 |      92 | 75-76                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  TagsBox.tsx                       |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 client/src/generated               |   47.56 |      100 |    1.15 |   47.56 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  graphql.tsx                       |   47.56 |      100 |    1.15 |   47.56 | 2061-2062,2110-2111,2189-2190,2195-2196,2239-2240,2289-2290,2339-2340,2413-2414,2425-2426,2484-2485,2496-2497,2542-2543,2584-2585,2596-2597,2642-2643,2654-2655,2712-2713,2763-2764,2814-2815,2871-2872,2921-2922,2972-2973,3020-3021,3081-3082,3126-3127,3138-3139,3209-3210,3221-3222,3281-3282,3293-3294,3354-3355,3366-3367,3410-3411,3422-3423,3486-3487,3544-3545,3595-3596,3646-3647,3697-3698,3747-3748,3801-3802,3850-3851,3903-3904,3951-3952,4009-4010,4021-4022,4124-4125,4136-4137,4182-4183,4194-4195,4239-4240,4251-4252,4295-4296,4307-4308,4361-4362,4415-4416,4464-4465,4476-4477,4534-4535,4546-4547,4600-4601,4645-4646,4657-4658,4704-4705,4713-4714,4769-4770,4829-4830,4880-4881,4937-4938,4949-4950,5016-5017,5025-5026,5076-5077,5126-5127,5176-5177,5226-5227,5302-5303,5314-5315,5406-5407,5415-5416,5461-5462,5516-5517,5528-5529,5654-5655,5666-5667,5715-5716 
 client/src/util                    |     100 |     87.5 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  capitalize.ts                     |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  date.ts                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  getLocationString.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  tags.ts                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  truncate.ts                       |     100 |       75 |     100 |     100 | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  venueType.ts                      |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 common                             |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  authorization.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  permissions.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  roles.ts                          |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 server/src                         |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  email-templates.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  prisma.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 server/src/authorization           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  index.ts                          |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 server/src/config                  |   85.19 |       50 |     100 |   77.78 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  index.ts                          |   85.19 |       50 |     100 |   77.78 | 8,33-39                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 server/src/services                |   50.85 |    42.47 |   56.86 |   52.07 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  Google.ts                         |   64.29 |    71.79 |   72.22 |   66.25 | 49-52,63-64,258-268,275-284,292-301                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  InitGoogle.ts                     |   29.69 |        0 |      10 |   31.15 | 30,43-113,118-124,129-160,168-173,177-181,189                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
  MailerService.ts                  |   47.62 |    33.33 |   33.33 |   47.62 | 24-28,35-39,50-61                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  UnsubscribeToken.ts               |    87.5 |      100 |      50 |   85.71 | 21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 server/src/services/mail-providers |    61.9 |    52.38 |      60 |      60 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  abstract-provider.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  sendgrid.ts                       |   27.27 |        0 |       0 |   27.27 | 9-40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  ses.ts                            |   27.27 |        0 |       0 |   27.27 | 13-50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  smtp-helpers.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  smtp.ts                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 server/src/util                    |   84.35 |    70.91 |   72.88 |   82.87 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  calendar.ts                       |   46.67 |        0 |       0 |   45.83 | 25-45,50-52,56-72                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  chapterAdministrator.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  chapterBans.ts                    |      75 |    42.86 |   33.33 |   71.43 | 39-54                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  date.ts                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  event-email.ts                    |   86.96 |    66.67 |   72.41 |   84.62 | 36,102-105,115-118,128-131,141-144,156-164,450-455                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  redact-secrets.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  tags.ts                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  venue.ts                          |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 server/tests/fixtures              |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  chapterUsers.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  events.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  objects-with-secrets.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  users.ts                          |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  venues.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
------------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
PASS server/tests/smtp-helpers.test.ts (28.281 s)
  allValuesAreDefined
    ✓ it should correctly catch undefined, null, and empty string values (1 ms)

PASS server/tests/tags.test.ts (28.2 s)
  tags
    createTagsData
      ✓ should return expected data for empty array (78 ms)
      ✓ should return expected data for array with unique tags (1 ms)
      ✓ should return only unique tags for array with duplicated tags (1 ms)

PASS client/tests/truncate.test.ts (28.903 s)
  truncate
    ✓ should truncate long enough sentences (2 ms)
    ✓ should not truncate sentences that are short enough
    ✓ should add an ellipsis when truncating (1 ms)
    ✓ should only truncate the minimum required to fit (2 ms)
    ✓ should handle long words (1 ms)

PASS server/tests/chapterAdministrator.test.ts (28.915 s)
  chapterAdministrator
    getInstanceRoleName
      for instance owner
        for admin of 1 chapter
          ✓ should return owner when changing to chapter 1 member (82 ms)
          ✓ should return owner when changing to chapter 1 administrator
        for admin of 2 chapter
          ✓ should return owner when changing to chapter 1 member (1 ms)
          ✓ should return owner when changing to chapter 1 administrator
        for admin of chapters
          ✓ should return owner when changing to chapter 1 member
          ✓ should return owner when changing to chapter 1 administrator
        for member of chapters
          ✓ should return owner when changing to chapter 1 member
          ✓ should return owner when changing to chapter 1 administrator (1 ms)
      for instance chapter_administrator
        for admin of 1 chapter
          ✓ should return member when changing to chapter 1 member
          ✓ should return chapter_administrator when changing to chapter 1 administrator
        for admin of 2 chapter
          ✓ should return chapter_administrator when changing to chapter 1 member (1 ms)
          ✓ should return chapter_administrator when changing to chapter 1 administrator (1 ms)
        for admin of chapters
          ✓ should return chapter_administrator when changing to chapter 1 member
          ✓ should return chapter_administrator when changing to chapter 1 administrator (1 ms)
      for instance member
        for member of chapters
          ✓ should return member when changing to chapter 1 member
          ✓ should return chapter_administrator when changing to chapter 1 administrator
    getRoleName
      for admin of 1 chapter
        ✓ should return chapter_administrator when changing from chapter_administrator to member (1 ms)
        ✓ should return chapter_administrator when changing from chapter_administrator to chapter_administrator
        ✓ should return owner when changing from chapter_administrator to owner
        ✓ should return chapter_administrator when changing from owner to member
        ✓ should return owner when changing from owner to owner (1 ms)
      for admin of 2 chapter
        ✓ should return chapter_administrator when changing from chapter_administrator to member
        ✓ should return chapter_administrator when changing from owner to member (1 ms)
        ✓ should return owner when changing from owner to owner
      for admin of chapters
        ✓ should return chapter_administrator when changing from chapter_administrator to member
        ✓ should return owner when changing from owner to owner (1 ms)
      for member of chapters
        ✓ should return member when changing from member to member
        ✓ should return member when changing from member to chapter_administrator (1 ms)
        ✓ should return owner when changing from member to owner (97 ms)
        ✓ should return member when changing from owner to member
        ✓ should return owner when changing from owner to owner
      for member of no chapters
        ✓ should return member when changing from member to chapter_administrator
        ✓ should return owner when changing from owner to owner
        ✓ should return owner when changing from member to owner (1 ms)
        ✓ should return member when changing from owner to member

PASS server/tests/MailerProvider.test.ts (29.097 s)
  SMTPProvider
    ✓ Should assign the email username, password, and service to transporter (7 ms)
    ✓ Should use 'bcc' if sending to multiple email addresses (83 ms)
    ✓ Should log a warning if emailUsername, emailPassword, or emailService is not specified (1 ms)

PASS server/tests/redact-secrets.test.ts (29.316 s)
  redactSecrets
    ✓ returns the original object if no secrets are found (9 ms)
    ✓ redacts Authorization (2 ms)
    ✓ redacts access_token
    ✓ redacts refesh_token
    ✓ redacts email (1 ms)
    ✓ redacts session keys and signatures inside cookies (1 ms)
    ✓ redacts secrets encoded as url params (1 ms)
    ✓ redacts secrets inside a JSON stringified body
    ✓ redacts secrets in nested objects (1 ms)
    ✓ handles circular objects (1 ms)
    ✓ handles circular objects with secrets (1 ms)
    ✓ handles a full response object (2 ms)
    ✓ handles an invalid grant (1 ms)
    ✓ does not mutate the original object (1 ms)
    ✓ can redact errors (93 ms)

PASS client/tests/tags.test.ts (29.9 s)
  tags
    parseTags
      ✓ should return array with expected tags for empty string (3 ms)
      ✓ should return array with expected tags for single tag (1 ms)
      ✓ should return array with expected tags for simple case
      ✓ should return array with expected tags for string with lots of empty space (1 ms)
      ✓ should return array with expected tags for string with two-word tag

PASS client/tests/capitalize.test.ts
  capitalize
    ✓ should capitalize a string (2 ms)
    ✓ should return an empty string if no string is passed

PASS server/tests/authorization.test.ts (30.011 s)
  authorizationChecker
    when user is NOT banned
      ✓ should reject if user is undefined (3 ms)
      ✓ should reject if user is defined, but events or venue is not (2 ms)
      ✓ should authorize if the events and venues properties exist, but are empty arrays (1 ms)
      ✓ should authorize if a user has an instance role granting permission (1 ms)
      ✓ should reject if a user does not have an instance role granting permission (1 ms)
      ✓ should authorize if a user has a chapter role granting permission (1 ms)
      ✓ should authorize if a user has a chapter role granting permission and the chapter is inferred from the event
      ✓ should authorize if a user has a chapter role granting permission and the chapter is inferred from the venue (5 ms)
      ✓ should reject if a user has a role for a chapter but a different chapter is inferred (1 ms)
      ✓ should reject if a user only has a chapter role granting permission for another chapter
      ✓ should authorize if a user has an event role granting permission (2 ms)
      ✓ should reject if a user only has an event role granting permission for another event (1 ms)
      ✓ should reject if the event is in a chapter for which the user has no role (1 ms)
      ✓ should authorize if a user has a chapter role, even if they do not have an event role (1 ms)
      ✓ should reject unless the number of required permissions is 1 (97 ms)
      ✓ should reject requests when the chapterId inferred from eventId does not match the provided chapterId (1 ms)
      ✓ should reject requests when the chapterId inferred from venue does not match the provided chapterId
      ✓ should reject requests when the chapterId inferred from eventId does not match the id inferred from venueId
      ✓ should reject event requests if the admin is not a member of that event's chapter
    when user is banned
      ✓ should authorize if a user has an instance role and a chapter ban (1 ms)
      ✓ should reject if a user has a chapter role and a ban for that chapter (1 ms)
      ✓ should authorize if a user has a chapter role for one chapter, but is banned from a different one (1 ms)
      ✓ should reject if a user has an event role and a ban for the owning chapter
      ✓ should authorize if a user has an event role and a ban for another chapter (6 ms)

PASS client/tests/getLocationString.test.ts
  getLocationString
    ✓ returns correct string with region, country and postal-code (2 ms)
    ✓ includes city, when withCity argument is true (1 ms)

PASS client/tests/venueType.test.ts
  venueType
    isOnline
      ✓ Online should return true (3 ms)
      ✓ Physical should return false (1 ms)
      ✓ PhysicalAndOnline should return true
    isPhysical
      ✓ Online should return false (1 ms)
      ✓ Physical should return true
      ✓ PhysicalAndOnline should return true

PASS client/tests/date.test.ts (30.601 s)
  date
    formatDate
      ✓ returns formatted date when passing datetime string #0 (3 ms)
      ✓ returns formatted date when passing datetime string #1 (1 ms)
      ✓ returns formatted date when passing datetime string #2
      ✓ returns formatted date when passing datetime string #3 (1 ms)
      ✓ returns formatted date when passing datetime string #4
      ✓ returns formatted date when passing datetime string #5
      ✓ returns formatted date when passing datetime string #6
      ✓ returns formatted date when passing datetime string #7
      ✓ returns formatted date when passing datetime string #8 (1 ms)
      ✓ returns formatted date when passing datetime string #9
      ✓ returns formatted date when passing datetime string #10 (1 ms)
      ✓ returns formatted date when passing datetime string #11

PASS server/tests/chapterBans.test.ts (30.726 s)
  chapterBans
    isBannable
      when user is instance owner
        ✓ should return false when userId is otherUserId (2 ms)
        ✓ should return false when other user is instance owner (1 ms)
        ✓ should return true when other user is chapter administrator
        ✓ should return true when other user is chapter member (1 ms)
      when user is chapter administrator
        ✓ should return false when userId is otherUserId
        ✓ should return false when other user is instance owner (1 ms)
        ✓ should return false when other user is chapter administrator
        ✓ should return true when other user is chapter member
      when user is chapter member
        ✓ should return false when userId is otherUserId (1 ms)
        ✓ should return false when other user is instance owner
        ✓ should return false when other user is chapter administrator (1 ms)
        ✓ should return false when other user is chapter member

PASS server/tests/email-templates.test.ts (30.904 s)
  email-templates
    streamingUrlChangeText
      ✓ should return url when url is given (1 ms)
      ✓ should return TBD when url is not given
    physicalLocationChangeText
      ✓ should return venue details when not all details are given (1 ms)
      ✓ should return venue details when all venue details are given
      ✓ should return TBD when venue is not given (1 ms)
    dateChangeText
      ✓ should return expected text (1 ms)
    chapterUserRoleChange
      ✓ should return object with expected subject
      ✓ should return object with expected emailText (1 ms)
    instanceUserRoleChange
      ✓ should return object with expected subject
      ✓ should return object with expected emailText
    invalidTokenNotification
      ✓ should return object with expected subject
      ✓ should return object with expected emailText
    venueTypeChangeText
      ✓ should return null when changing venue_type from Online to Online (1 ms)
      ✓ should return expected string when changing venue_type from Online to Physical (4 ms)
      ✓ should return expected string when changing venue_type from Online to PhysicalAndOnline (1 ms)
      ✓ should return expected string when changing venue_type from Physical to Online
      ✓ should return null when changing venue_type from Physical to Physical
      ✓ should return expected string when changing venue_type from Physical to PhysicalAndOnline
      ✓ should return expected string when changing venue_type from PhysicalAndOnline to Online (1 ms)
      ✓ should return expected string when changing venue_type from PhysicalAndOnline to Physical
      ✓ should return null when changing venue_type from PhysicalAndOnline to PhysicalAndOnline
    chapterUnsubscribeText
      ✓ should return expected text
    eventUnsubscribeText
      ✓ should return expected text
    eventListUnsubscribeText
      ✓ should return expected text

PASS server/tests/google.test.ts (31.119 s)
  Google Service
    removeEventAttendee
      ✓ should update everyone and configure guest permissions (4 ms)
      ✓ should remove the attendee from the event for future event (1 ms)
      ✓ should not update attendees for past events (1 ms)
      ✓ should do nothing if the email is not one of the attendee's (1 ms)
    addEventAttendee
      ✓ should update everyone and configure guest permissions (1 ms)
      ✓ should add the attendee to the event for future event
      ✓ should not update attendees for past events (1 ms)
    cancelEventAttendance
      ✓ should update everyone and configure guest permissions (1 ms)
      ✓ should cancel (but not remove) attendance for future event
      ✓ should not update attendees for past events (1 ms)
    createCalendarEvent
      ✓ should update everyone, configure guest permissions and not add a meet (1 ms)
      ✓ include event details in the request to Google (1 ms)
      ✓ when createMeet is true should include meet creation in the request to Google
      ✓ when createMeet is false should not include meet creation in the request to Google (1 ms)
      ✓ should include attendees details for future event (1 ms)
      ✓ should ignore attendees details for event in the past
    updateCalendarEventDetails
      ✓ should update everyone and configure guest permissions (1 ms)
      ✓ ignores attendees in the request to Google
      ✓ when createMeet is true should request meet creation in the request to Google (1 ms)
      ✓ when createMeet is false should not request meet creation in the request to Google
      ✓ when removeMeet is true should request meet removal in the request to Google (1 ms)
      ✓ when removeMeet is false should not request meet removal in the request to Google
    createCalendar
      ✓ should insert a new calendar with a summary and description
    deleteCalendarEvent
      ✓ should call the delete endpoint

FAIL server/tests/event-email.test.ts (31.207 s)
  event-email
    eventInviteEmail
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (4 ms)
      ✓ should return object with expected subject
      ✕ should return object with expected emailText for Physical & Online event (6 ms)
      ✕ should return object with expected emailText for in-person only event (3 ms)
      ✕ should return object with expected emailText for online-only event (2 ms)
    eventCancelationEmail
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (1 ms)
      ✓ should return object with expected subject (1 ms)
      ✕ should return object with expected emailText (3 ms)
    eventConfirmAttendeeEmail
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (1 ms)
      ✓ should return object with expected subject
      ✓ should return object with expected emailText (1 ms)
    eventAttendeeToWaitlistEmail
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (1 ms)
      ✓ should return object with expected subject
      ✓ should return object with expected emailText
    eventNewAttendeeNotifyEmail
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (2 ms)
      ✓ should return object with expected subject
      ✓ should return object with expected emailText (1 ms)
    eventAttendanceConfirmation
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (3 ms)
      ✓ should return object with expected subject (1 ms)
      ✓ should return object with expected emailText (1 ms)
    buildEmailForUpdatedEvent
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (3 ms)
      ✓ should return object with expected subject
      ✓ should return object with expected emailText (1 ms)
    eventAttendanceCancelation
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (1 ms)
      ✓ should return object with expected subject (31 ms)
      ✓ should return object with expected emailText for Physical & Online event
    eventWaitlistConfirmation
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties
      ✓ should return object with expected subject (1 ms)
      ✓ should return object with expected emailText for Physical & Online event
    eventAttendanceRequest
      ✓ should return object with subject, emailText, attachUnsubscribe and attachUnsubscribeText properties (1 ms)
      ✓ should return object with expected subject
      ✓ should return object with expected emailText for Physical & Online event (1 ms)

  ● event-email › eventInviteEmail › should return object with expected emailText for Physical & Online event

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -3,16 +3,16 @@
      When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      <br />
      Where: Undecided/TBD<br />
      Streaming URL: Undecided/TBD<br />
      <br />
    - Go to <a href="http://localhost:3000/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
    + Go to <a href="https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
      ----------------------------<br />
      <br />

      About the event: <br />
      additional description<br />
      ----------------------------<br />
      <br />

    - View all upcoming events for Not so serious: <a href='http://localhost:3000/chapters/1'>Not so serious chapter</a>.<br />
    + View all upcoming events for Not so serious: <a href='https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/chapters/1'>Not so serious chapter</a>.<br />
      <br />

      46 |     it('should return object with expected emailText for Physical & Online event', () => {
      47 |       const { emailText } = eventInviteEmail(data);
    > 48 |       expect(emailText).toEqual(`Upcoming event for Not so serious.<br />
         |                         ^
      49 | <br />
      50 | When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      51 | <br />

      at Object.<anonymous> (server/tests/event-email.test.ts:48:25)

  ● event-email › eventInviteEmail › should return object with expected emailText for in-person only event

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -2,16 +2,16 @@
      <br />
      When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      <br />
      Where: Undecided/TBD<br />
      <br />
    - Go to <a href="http://localhost:3000/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
    + Go to <a href="https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
      ----------------------------<br />
      <br />

      About the event: <br />
      additional description<br />
      ----------------------------<br />
      <br />

    - View all upcoming events for Not so serious: <a href='http://localhost:3000/chapters/1'>Not so serious chapter</a>.<br />
    + View all upcoming events for Not so serious: <a href='https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/chapters/1'>Not so serious chapter</a>.<br />
      <br />

      71 |         venue_type: events_venue_type_enum.Physical,
      72 |       });
    > 73 |       expect(emailText).toEqual(`Upcoming event for Not so serious.<br />
         |                         ^
      74 | <br />
      75 | When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      76 | <br />

      at Object.<anonymous> (server/tests/event-email.test.ts:73:25)

  ● event-email › eventInviteEmail › should return object with expected emailText for online-only event

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -2,16 +2,16 @@
      <br />
      When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      <br />
      Streaming URL: Undecided/TBD<br />
      <br />
    - Go to <a href="http://localhost:3000/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
    + Go to <a href="https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/events/1?confirm_attendance=true">the event page</a> to confirm your attendance.<br />
      ----------------------------<br />
      <br />

      About the event: <br />
      additional description<br />
      ----------------------------<br />
      <br />

    - View all upcoming events for Not so serious: <a href='http://localhost:3000/chapters/1'>Not so serious chapter</a>.<br />
    + View all upcoming events for Not so serious: <a href='https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/chapters/1'>Not so serious chapter</a>.<br />
      <br />

       95 |         venue_type: events_venue_type_enum.Online,
       96 |       });
    >  97 |       expect(emailText).toEqual(`Upcoming event for Not so serious.<br />
          |                         ^
       98 | <br />
       99 | When: Tue Feb 07 2023 12:00:00 GMT+0000 (Coordinated Universal Time) to Tue Feb 07 2023 12:30:00 GMT+0000 (Coordinated Universal Time)
      100 | <br />

      at Object.<anonymous> (server/tests/event-email.test.ts:97:25)

  ● event-email › eventCancelationEmail › should return object with expected emailText

    expect(received).toMatchObject(expected)

    - Expected  - 1
    + Received  + 1

      Object {
        "emailText": "The upcoming event Hammes - Sawayn has been canceled.<br />
      <br />
    - View upcoming events for Stehr Group: <a href='http://localhost:3000/chapters/1'>Stehr Group chapter</a>.<br />
    + View upcoming events for Stehr Group: <a href='https://3000-freecodecamp-chapter-gpmk4nsa9yf.ws-us99.gitpod.io/chapters/1'>Stehr Group chapter</a>.<br />
      You received this email because you Subscribed to Hammes - Sawayn Event.<br />",
      }

      140 | You received this email because you Subscribed to Hammes - Sawayn Event.<br />`,
      141 |       };
    > 142 |       expect(eventCancelationEmail(data)).toMatchObject(expected);
          |                                           ^
      143 |     });
      144 |   });
      145 |

      at Object.<anonymous> (server/tests/event-email.test.ts:142:43)

PASS client/tests/EventCard.test.tsx (29.262 s)
  EventCard
    ✓ should render (65 ms)
    ✓ should render with tags (18 ms)

PASS client/tests/ChapterCard.test.tsx (29.665 s)
  ChapterCard
    ✓ should render (171 ms)
    ✓ should render with tags (80 ms)

Test Suites: 1 failed, 17 passed, 18 total
Tests:       4 failed, 205 passed, 209 total
Snapshots:   4 passed, 4 total
Time:        33.211 s, estimated 41 s
Ran all test suites.
